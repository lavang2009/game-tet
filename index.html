<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
    <title>L·ªÖ H·ªôi Game T·∫øt 2026 ‚Äì Menu (v5.5 Local Files)</title>
    <style>
        /* Typography & Variables */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@600;800&family=Mali:wght@500;700&display=swap');

        :root {
            --accent: #ffd54f;
            --banner-start: #ff1744;
            --banner-end: #ffd600;
            --btn-bg: #ffd700;
            --text: #ffffff;
            --overlay-a: 0.25;
            --overlay-b: 0.45;
            --color-01: #ff4757;
            --color-02: #ffa502;
            --color-03: #2ed573;
            --color-04: #70a1ff;
            --font-main: 'Inter', sans-serif;
            --font-accent: 'Mali', cursive;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body {
            overflow: hidden;
            font-family: var(--font-main);
            background: #000;
            color: var(--text);
            height: 100vh;
            width: 100vw;
            transition: background 0.5s ease;
        }

        /* Background Layer */
        #bgContainer {
            position: fixed;
            inset: 0;
            z-index: 0;
            background-size: cover;
            background-position: center;
            transition: background-image 0.8s ease-in-out;
        }

        .bg-overlay {
            position: absolute;
            inset: 0;
            background: linear-gradient(rgba(0,0,0,var(--overlay-a)), rgba(0,0,0,var(--overlay-b)));
            z-index: 1;
        }

        /* Animated Color Blurs */
        .fireworks-area { position: fixed; inset: 0; z-index: 2; pointer-events: none; }
        .animate-color { position: absolute; inset: 0; mix-blend-mode: screen; opacity: 0.4; }
        .animate-color__item { width: 40vw; height: 40vh; position: absolute; filter: blur(80px); border-radius: 50%; }
        .animate-color__item:nth-child(1) { background: var(--color-01); animation: ac1 10s infinite alternate; top: 0; right: 0; }
        .animate-color__item:nth-child(2) { background: var(--color-02); animation: ac2 12s infinite alternate; bottom: 0; left: 0; }
        
        @keyframes ac1 { 0% { transform: translate(0, 0); } 100% { transform: translate(-50%, 50%); } }
        @keyframes ac2 { 0% { transform: translate(0, 0); } 100% { transform: translate(50%, -50%); } }

        /* Canvas */
        #fireworksCanvas { position: fixed; inset: 0; z-index: 3; pointer-events: none; }

        /* Banner & Typewriter */
        .banner {
            position: fixed; top: 0; width: 100%; height: 60px;
            background: linear-gradient(90deg, var(--banner-start), var(--banner-end));
            display: flex; align-items: center; justify-content: center;
            z-index: 10; box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }
        #aiText { font-weight: 800; font-size: clamp(14px, 4vw, 18px); color: #4a1200; text-transform: uppercase; letter-spacing: 0.5px; }
        .cursor { width: 3px; height: 1.2em; background: #4a1200; margin-left: 5px; animation: blink 0.8s infinite; }
        @keyframes blink { 50% { opacity: 0; } }

        /* UI Containers */
        .ui-layer { position: relative; z-index: 10; height: 100%; display: flex; flex-direction: column; align-items: center; padding-top: 80px; pointer-events: none; }
        .ui-layer > * { pointer-events: auto; }

        /* Header & Countdown */
        .header h1 { 
            font-family: var(--font-accent); 
            font-size: clamp(1.8rem, 6vw, 3.2rem); 
            color: var(--accent); 
            text-shadow: 0 0 15px rgba(255,213,79,0.5), 2px 2px 4px rgba(0,0,0,0.5);
            margin-bottom: 15px;
            text-align: center;
        }

        .timeboxes { display: flex; gap: 10px; justify-content: center; }
        .timebox { 
            background: rgba(0,0,0,0.5); 
            backdrop-filter: blur(5px);
            padding: 10px; border-radius: 12px; 
            min-width: 70px; text-align: center;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .timebox .num { font-weight: 800; font-size: 1.4rem; color: #fff; display: block; }
        .timebox .lbl { font-size: 0.7rem; color: var(--accent); text-transform: uppercase; font-weight: 600; }

        /* Controls Groups */
        .control-pill {
            background: rgba(255,255,255,0.15); backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2); border-radius: 20px;
            padding: 8px 15px; color: #fff; font-size: 13px; font-weight: 600;
            display: flex; align-items: center; gap: 8px; cursor: pointer; user-select: none;
            transition: background 0.2s;
        }
        .control-pill:hover { background: rgba(255,255,255,0.25); }

        /* LEFT: Fireworks Controls */
        .left-controls { position: fixed; left: 15px; top: 75px; display: flex; flex-direction: column; gap: 10px; z-index: 20; }
        
        /* RIGHT: Music Controls */
        .right-controls { position: fixed; right: 15px; top: 75px; display: flex; flex-direction: column; gap: 10px; align-items: flex-end; z-index: 20; }

        /* RIGHT: Settings Buttons */
        .settings-group { position: fixed; right: 15px; top: 165px; display: flex; flex-direction: column; gap: 10px; z-index: 20; }
        
        .circle-btn {
            width: 45px; height: 45px; border-radius: 50%; border: none; 
            background: var(--btn-bg); color: #4a1200; font-size: 20px;
            cursor: pointer; display: flex; align-items: center; justify-content: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3); transition: transform 0.2s;
        }
        .circle-btn:active { transform: scale(0.9); }

        /* Sliders Styling */
        input[type=range] {
            -webkit-appearance: none; background: rgba(255,255,255,0.3);
            height: 4px; border-radius: 2px; outline: none;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none; width: 14px; height: 14px; border-radius: 50%;
            background: var(--accent); cursor: pointer; border: 2px solid #fff;
        }

        /* Menu */
        .menu { 
            margin-top: auto; margin-bottom: 50px;
            display: flex; gap: 20px; width: 100%; justify-content: center; padding: 20px;
        }
        .game-card {
            width: 220px; background: rgba(255,255,255,0.1); backdrop-filter: blur(15px);
            border-radius: 24px; padding: 25px 15px; text-align: center;
            border: 1px solid rgba(255,255,255,0.1); transition: 0.3s; cursor: pointer;
        }
        .game-card:hover { transform: translateY(-10px); background: rgba(255,255,255,0.15); border-color: var(--accent); }
        .game-card .icon { font-size: 50px; margin-bottom: 15px; display: block; }
        .game-card h2 { font-size: 1.2rem; color: var(--accent); margin-bottom: 5px; }
        .game-card p { font-size: 0.85rem; opacity: 0.8; }

        /* Overlay Popups */
        .popup { 
            position: fixed; inset: 0; background: rgba(0,0,0,0.8); 
            display: none; align-items: center; justify-content: center; z-index: 100;
            padding: 20px;
        }
        .popup-box { 
            background: #fff; color: #333; padding: 25px; border-radius: 20px; 
            max-width: 450px; width: 100%; box-shadow: 0 20px 50px rgba(0,0,0,0.5);
        }
        .popup-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        
        .toast {
            position: fixed; top: 80px; left: 50%; transform: translateX(-50%);
            background: #4a1200; color: #ffd700; padding: 10px 25px; border-radius: 30px;
            font-weight: 700; z-index: 1000; box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown { from { top: 40px; opacity: 0; } to { top: 80px; opacity: 1; } }

        /* --- PH·∫¶N TH√äM M·ªöI: CSS CHO HOA R∆†I --- */
        .petal {
            position: fixed;
            top: -10%;
            z-index: 5;
            pointer-events: none;
            user-select: none;
            animation: fall linear infinite;
        }
        @keyframes fall {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(110vh) rotate(720deg); opacity: 0; }
        }
        /* -------------------------------------- */

        @media (max-width: 768px) {
            .menu { flex-direction: column; align-items: center; }
            .game-card { width: 90%; padding: 15px; }
            /* Mobile Layout Adjustments */
            .settings-group { top: auto; bottom: 20px; right: 20px; flex-direction: row; }
            .left-controls { top: 70px; left: 10px; transform: scale(0.9); transform-origin: top left; }
            .right-controls { top: 70px; right: 10px; transform: scale(0.9); transform-origin: top right; }
        }
    </style>
</head>
<body>

    <div id="bgContainer"></div>
    <div class="bg-overlay"></div>

    <div class="fireworks-area" id="fireworksArea">
        <div class="animate-color">
            <div class="animate-color__item"></div>
            <div class="animate-color__item"></div>
        </div>
    </div>

    <canvas id="fireworksCanvas"></canvas>

    <div class="banner">
        <span id="aiText"></span><div class="cursor"></div>
    </div>

    <div class="left-controls">
        <div class="control-pill" id="fwToggle">üéá Ph√°o hoa: B·∫≠t</div>
        <div class="control-pill" id="petalToggle">üå∏ Hoa r∆°i: B·∫≠t</div>
        <div class="control-pill">
            M·ª©c: <input id="fwIntensity" type="range" min="1" max="5" value="3" style="width:60px" />
        </div>
        <div class="control-pill" id="autoStopBtn">‚è≥ H·∫πn gi·ªù t·∫Øt</div>
    </div>

    <div class="right-controls">
        <div class="control-pill" id="musicPill">üéµ Nh·∫°c: T·∫Øt</div>
        <div class="control-pill">
            Vol: <input id="volSlider" type="range" min="0" max="1" step="0.1" value="0.5" style="width:60px" />
        </div>
    </div>

    <div class="settings-group">
        <button class="circle-btn" id="themeBtn" onclick="toggleTheme()" title="Theme">üåó</button>
        <button class="circle-btn" onclick="changeBg()" title="ƒê·ªïi n·ªÅn">üñºÔ∏è</button>
        <button class="circle-btn" onclick="showInfo()" title="Th√¥ng tin">‚ÑπÔ∏è</button>
    </div>

    <div class="ui-layer">
        <header class="header">
            <h1>üéâ L·ªÑ H·ªòI GAME T·∫æT 2026 üéâ</h1>
            <div class="timeboxes">
                <div class="timebox"><span class="num" id="days">00</span><span class="lbl">Ng√†y</span></div>
                <div class="timebox"><span class="num" id="hours">00</span><span class="lbl">Gi·ªù</span></div>
                <div class="timebox"><span class="num" id="minutes">00</span><span class="lbl">Ph√∫t</span></div>
                <div class="timebox"><span class="num" id="seconds">00</span><span class="lbl">Gi√¢y</span></div>
            </div>
        </header>

        <nav class="menu">
            <div class="game-card"
                onclick="goGame('le-hoi-xao-tron-2026/coc.html')" 
                tabindex="0"
                onkeypress="if(event.key==='Enter') goGame('le-hoi-xao-tron-2026/coc.html')">
                <span class="icon">ü•õ</span>
                <h2>3 C·ªêC B√ìNG</h2>
                <p>Th·ª≠ th√°ch tr√≠ nh·ªõ si√™u ph√†m</p>
            </div>
            <div class="game-card"
                onclick="goGame('le-hoi-caro-2026/caro.html')" 
                tabindex="0"
                onkeypress="if(event.key==='Enter') goGame('le-hoi-caro-2026/caro.html')">
                <span class="icon">‚ôüÔ∏è</span>
                <h2>C·ªú CARO</h2>
                <p>ƒê·∫•u tr√≠ c√πng AI th√¥ng minh</p>
            </div>
        </nav>
    </div>

<div class="popup" id="infoPopup">
    <div class="popup-box">
        <div class="popup-header">
            <h3>üì¢ Th√¥ng tin & ƒêi·ªÅu kho·∫£n</h3>
            <button onclick="closeInfo()" style="border:none; background:none; font-size:24px; cursor:pointer">&times;</button>
        </div>

        <div style="font-size:14px; line-height:1.65; max-height:65vh; overflow:auto">

            <p><b>Phi√™n b·∫£n:</b> v5.5 ‚Äì T·∫øt 2026 <br> B·∫£n v5.6 s·∫Ω s·ªõm ra m·∫Øt</p>
            <p><b>B·∫£n quy·ªÅn:</b> ¬© 2026 Luavang Studio</p>

            <hr style="margin:10px 0; opacity:0.25">

            <p>
                Ch√†o m·ª´ng b·∫°n ƒë·∫øn v·ªõi <b>L·ªÖ H·ªôi Game T·∫øt 2026</b>.  
                ƒê√¢y l√† c·ªïng game gi·∫£i tr√≠ ng√†y T·∫øt, mang l·∫°i tr·∫£i nghi·ªám vui v·∫ª,
                may m·∫Øn v√† kh√¥ng kh√≠ xu√¢n r·ªôn r√†ng cho ng∆∞·ªùi ch∆°i.  
                H√£y t·∫≠n h∆∞·ªüng nh·ªØng tr√≤ ch∆°i th√∫ v·ªã, ph√°o hoa r·ª±c r·ª° v√† √¢m nh·∫°c T·∫øt s√¥i ƒë·ªông!
            </p>

            <h4 style="margin-top:10px">T√≠nh nƒÉng n·ªïi b·∫≠t</h4>
            <ul style="margin-left:20px">
                <li>Ph√°o hoa canvas nhi·ªÅu hi·ªáu ·ª©ng, nh·∫π & m∆∞·ª£t.</li>
                <li>Nh·∫°c T·∫øt b·∫≠t / t·∫Øt, ch·ªânh √¢m l∆∞·ª£ng.</li>
                <li>Hi·ªáu ·ª©ng hoa r∆°i</li>
                <li>ƒê·ªïi nhi·ªÅu ·∫£nh n·ªÅn T·∫øt. ƒêang ƒë∆∞·ª£c ph√°t tri·ªÉn</li>
                <li>AI t·ª± ƒë·ªông vi·∫øt l·ªùi ch√∫c nƒÉm m·ªõi.</li>
                <li>Ch·∫ø ƒë·ªô s√°ng / t·ªëi.</li>
                <li>T∆∞∆°ng th√≠ch PC & Mobile.</li>
            </ul>

            <h4 style="margin-top:10px">L·ªùi ch√∫c nƒÉm m·ªõi</h4>
            <ul style="margin-left:20px">
                <li>An khang th·ªãnh v∆∞·ª£ng</li>
                <li>V·∫°n s·ª± nh∆∞ √Ω</li>
                <li>S·ª©c kh·ªèe d·ªìi d√†o ‚Äì ch∆°i game th·∫Øng l·ªõn</li>
                <li>T·∫øt n√†y r·ª±c r·ª° h∆°n T·∫øt tr∆∞·ªõc</li>
            </ul>

            <h4 style="margin-top:10px">ƒêi·ªÅu kho·∫£n s·ª≠ d·ª•ng</h4>
            <ol style="margin-left:20px">
                <li>‚ùå C·∫•m s·ª≠ d·ª•ng hack, bot, tool gian l·∫≠n.</li>
                <li>‚ùå Kh√¥ng khai th√°c l·ªói h·ªá th·ªëng ƒë·ªÉ tr·ª•c l·ª£i.</li>
                <li>üë§ Ng∆∞·ªùi ch∆°i ch·ªãu tr√°ch nhi·ªám v·ªõi t√™n trong game.</li>
                <li>üõë Vi ph·∫°m c√≥ th·ªÉ b·ªã kh√≥a t·∫°m th·ªùi ho·∫∑c vƒ©nh vi·ªÖn.</li>
                <li>üîí Kh√¥ng thu th·∫≠p d·ªØ li·ªáu c√° nh√¢n nh·∫°y c·∫£m.</li>
                <li>‚ö†Ô∏è H·ªá th·ªëng c√≥ th·ªÉ c·∫≠p nh·∫≠t lu·∫≠t ƒë·ªÉ ƒë·∫£m b·∫£o c√¥ng b·∫±ng.</li>
            </ol>

            <p style="margin-top:10px; font-size:13px; opacity:0.85">
                  Game mang t√≠nh gi·∫£i tr√≠ ng√†y T·∫øt, kh√¥ng quy ƒë·ªïi ti·ªÅn th·∫≠t.
                D·ªØ li·ªáu c√≥ th·ªÉ ƒë∆∞·ª£c reset sau khi k·∫øt th√∫c s·ª± ki·ªán.
            </p>
            <p style="margin-top:10px; text-align:center; font-weight:600">
                üéâ Luavang Studio xin k√≠nh ch√∫c qu√Ω kh√°ch m·ªôt nƒÉm m·ªõi an khang th·ªãnh v∆∞·ª£ng! üéâ
            </p>
        </div>
    </div>
</div>

    <audio id="bgm" loop></audio>

    <script>
        /* CONFIGURATION */
        // --- THAY ƒê·ªîI ·ªû ƒê√ÇY: T√™n c√°c file ·∫£nh c·ªßa b·∫°n ---
        const BG_IMAGES = [
            'assets/tet/anh1.jpg',
            'assets/tet/anh2.jpg',
            'assets/tet/anh3.jpg',
            'assets/tet/anh4.jpg',
            'assets/tet/anh5.jpg',
            'assets/tet/anh6.jpg'
            // B·∫°n c√≥ th·ªÉ th√™m 'anh-nen-4.png', v.v. n·∫øu mu·ªën
        ];

        let currentBgIdx = 0;
        let fwEnabled = true;
        let musicOn = false;
        let intensity = 3;
        // TH√äM M·ªöI: Bi·∫øn ki·ªÉm so√°t hoa r∆°i
        let petalsEnabled = true;

        /* INITIALIZATION */
        window.onload = () => {
            changeBg(0);
            startCountdown();
            startTypewriter();
            initFireworks();
            // TH√äM M·ªöI: Kh·ªüi t·∫°o hoa r∆°i
            initPetals();
            
            // Set initial volume
            const bgm = document.getElementById('bgm');
            bgm.volume = 0.5;
            
            // Context menu protection
            document.addEventListener('contextmenu', e => e.preventDefault());
        };

        /* UI HELPERS */
        function toast(msg) {
            const t = document.createElement('div');
            t.className = 'toast';
            t.innerText = msg;
            document.body.appendChild(t);
            setTimeout(() => t.remove(), 3000);
        }

        function changeBg(idx) {
            if (idx !== undefined) currentBgIdx = idx;
            else currentBgIdx = (currentBgIdx + 1) % BG_IMAGES.length;
            
            const container = document.getElementById('bgContainer');
            // S·ª≠ d·ª•ng ·∫£nh c·ª•c b·ªô
            container.style.backgroundImage = `url('${BG_IMAGES[currentBgIdx]}')`;
        }

        function showInfo() { document.getElementById('infoPopup').style.display = 'flex'; }
        function closeInfo() { document.getElementById('infoPopup').style.display = 'none'; }

        /* TYPEWRITER */
        const quotes = [
            "Ch√∫c m·ª´ng nƒÉm m·ªõi B√≠nh Ng·ªç 2026!",
            "An khang th·ªãnh v∆∞·ª£ng - V·∫°n s·ª± nh∆∞ √Ω!",
            "Ph√°t t√†i ph√°t l·ªôc - S·ª©c kh·ªèe d·ªìi d√†o!",
            "T·∫øt ƒë·∫øn xu√¢n v·ªÅ - Game hay m√™ m·ªát!",
            "C√πng ch∆°i, c√πng vui - ƒê√≥n T·∫øt r·ªôn r√†ng!",
            "Ch∆°i game, gi·∫£i tr√≠ - T·∫øt th√™m √Ω nghƒ©a!",
            "NƒÉm m·ªõi th·∫Øng l·ª£i - Game c√†ng h∆∞ng th·ªãnh!",
            "Xu√¢n sang r·ªôn r√£ - Game vui b·∫•t t·∫≠n!"
        ];
        let qIdx = 0, charIdx = 0;
        function startTypewriter() {
            const el = document.getElementById('aiText');
            if (charIdx < quotes[qIdx].length) {
                el.textContent += quotes[qIdx][charIdx++];
                setTimeout(startTypewriter, 50);
            } else {
                setTimeout(() => {
                    el.textContent = "";
                    charIdx = 0;
                    qIdx = (qIdx + 1) % quotes.length;
                    startTypewriter();
                }, 2500);
            }
        }

        /* COUNTDOWN */
        function startCountdown() {
            const target = new Date("Feb 17, 2026 00:00:00").getTime();
            setInterval(() => {
                const now = new Date().getTime();
                const diff = target - now;
                
                const d = Math.floor(diff / (1000 * 60 * 60 * 24));
                const h = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const m = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                const s = Math.floor((diff % (1000 * 60)) / 1000);

                document.getElementById('days').innerText = String(d).padStart(2, '0');
                document.getElementById('hours').innerText = String(h).padStart(2, '0');
                document.getElementById('minutes').innerText = String(m).padStart(2, '0');
                document.getElementById('seconds').innerText = String(s).padStart(2, '0');
            }, 1000);
        }

        /* MUSIC CONTROLS (LOCAL FILE) */
        const musicPill = document.getElementById('musicPill');
        const volSlider = document.getElementById('volSlider');
        const bgm = document.getElementById('bgm');
        
        // File nh·∫°c c·ª•c b·ªô
        bgm.src = "nhac-tet.mp3"; 

        musicPill.onclick = () => {
            if (!musicOn) {
                bgm.play().then(() => {
                    musicOn = true;
                    musicPill.innerText = "‚è∏Ô∏è Nh·∫°c: B·∫≠t";
                    toast("üé∂ ƒêang ph√°t nh·∫°c Xu√¢n");
                }).catch((error) => {
                    console.error(error);
                    toast("‚ö†Ô∏è Kh√¥ng t√¨m th·∫•y file 'nhac-tet.mp3'!");
                });
            } else {
                bgm.pause();
                musicOn = false;
                musicPill.innerText = "üéµ Nh·∫°c: T·∫Øt";
            }
        };

        volSlider.oninput = (e) => {
            bgm.volume = e.target.value;
            if(bgm.volume == 0) musicPill.innerText = "üîá Nh·∫°c: Im l·∫∑ng";
            else if(musicOn) musicPill.innerText = "‚è∏Ô∏è Nh·∫°c: B·∫≠t";
        };

        /* FIREWORKS ENGINE */
        const canvas = document.getElementById('fireworksCanvas');
        const ctx = canvas.getContext('2d');
        let particles = [];
        let rockets = [];

        function initFireworks() {
            resize();
            window.addEventListener('resize', resize);
            render();
        }

        function resize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }

        class Rocket {
            constructor() {
                this.x = Math.random() * canvas.width;
                this.y = canvas.height;
                this.speed = 10 + Math.random() * 5;
                this.angle = Math.PI * 1.5 + (Math.random() * 0.2 - 0.1);
                this.color = `hsl(${Math.random() * 360}, 100%, 60%)`;
                this.alive = true;
            }
            update() {
                this.x += Math.cos(this.angle) * this.speed;
                this.y += Math.sin(this.angle) * this.speed;
                if (this.y < canvas.height * 0.2 + Math.random() * 200) {
                    this.alive = false;
                    explode(this.x, this.y, this.color);
                }
            }
            draw() {
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, 2, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        class Particle {
            constructor(x, y, color) {
                this.x = x; this.y = y;
                this.color = color;
                this.angle = Math.random() * Math.PI * 2;
                this.speed = Math.random() * 4 + 2;
                this.friction = 0.95;
                this.gravity = 0.1;
                this.alpha = 1;
                this.decay = Math.random() * 0.02 + 0.01;
            }
            update() {
                this.speed *= this.friction;
                this.x += Math.cos(this.angle) * this.speed;
                this.y += Math.sin(this.angle) * this.speed + this.gravity;
                this.alpha -= this.decay;
            }
            draw() {
                ctx.globalAlpha = this.alpha;
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, 1.5, 0, Math.PI * 2);
                ctx.fill();
                ctx.globalAlpha = 1;
            }
        }

        function explode(x, y, color) {
            const count = intensity * 20;
            for (let i = 0; i < count; i++) {
                particles.push(new Particle(x, y, color));
            }
        }

        function render() {
            ctx.fillStyle = 'rgba(0, 0, 0, 0.15)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            if (fwEnabled && Math.random() < 0.03 * intensity) {
                rockets.push(new Rocket());
            }

            rockets.forEach((r, i) => {
                r.update();
                r.draw();
                if (!r.alive) rockets.splice(i, 1);
            });

            particles.forEach((p, i) => {
                p.update();
                p.draw();
                if (p.alpha <= 0) particles.splice(i, 1);
            });

            requestAnimationFrame(render);
        }

        /* FW CONTROLS */
        document.getElementById('fwToggle').onclick = function() {
            fwEnabled = !fwEnabled;
            this.innerText = fwEnabled ? "üéá Ph√°o hoa: B·∫≠t" : "üéá Ph√°o hoa: T·∫Øt";
            document.getElementById('fireworksArea').style.display = fwEnabled ? 'block' : 'none';
        };

        document.getElementById('fwIntensity').oninput = (e) => {
            intensity = e.target.value;
        };

        document.getElementById('autoStopBtn').onclick = () => {
            const time = prompt("T·ª± ƒë·ªông t·∫Øt sau bao nhi√™u gi√¢y?", "30");
            if (time) {
                toast(`‚è≥ S·∫Ω t·∫Øt ph√°o hoa sau ${time}s`);
                setTimeout(() => {
                    fwEnabled = false;
                    document.getElementById('fwToggle').innerText = "üéá Ph√°o hoa: T·∫Øt";
                    toast("üéÜ ƒê√£ t·ª± ƒë·ªông t·∫Øt ph√°o hoa");
                }, time * 1000);
            }
        };

        function toggleTheme() {
            document.body.classList.toggle('light-theme');
            if (document.body.classList.contains('light-theme')) {
                document.querySelector('.bg-overlay').style.background = 'rgba(255,255,255,0.2)';
                toast("‚òÄÔ∏è ƒê√£ chuy·ªÉn sang ch·∫ø ƒë·ªô s√°ng");
            } else {
                document.querySelector('.bg-overlay').style.background = 'linear-gradient(rgba(0,0,0,var(--overlay-a)), rgba(0,0,0,var(--overlay-b)))';
                toast("üåô ƒê√£ chuy·ªÉn sang ch·∫ø ƒë·ªô t·ªëi");
            }
        }

        // --- PH·∫¶N TH√äM M·ªöI: H√ÄM X·ª¨ L√ù HOA R∆†I ---
        function initPetals() {
            setInterval(() => {
                if(petalsEnabled) createPetal();
            }, 300);

            document.getElementById('petalToggle').onclick = function() {
                petalsEnabled = !petalsEnabled;
                this.innerText = petalsEnabled ? "üå∏ Hoa r∆°i: B·∫≠t" : "üå∏ Hoa r∆°i: T·∫Øt";
                if(!petalsEnabled) {
                    document.querySelectorAll('.petal').forEach(p => p.remove());
                }
            };
        }

        function createPetal() {
            const petal = document.createElement('div');
            petal.className = 'petal';
            // Ng·∫´u nhi√™n ch·ªçn hoa mai (v√†ng) ho·∫∑c hoa ƒë√†o (h·ªìng)
            const isMai = Math.random() > 0.5;
            petal.innerHTML = isMai ? 'üå∏' : 'üíÆ'; 
            petal.style.left = Math.random() * 100 + 'vw';
            petal.style.fontSize = (Math.random() * 15 + 10) + 'px';
            petal.style.animationDuration = (Math.random() * 3 + 4) + 's';
            petal.style.filter = `hue-rotate(${Math.random() * 20}deg)`;
            document.body.appendChild(petal);
            setTimeout(() => petal.remove(), 7000);
        }
        // ----------------------------------------

        // --- H√ÄM CHUY·ªÇN TRANG TR√í CH∆†I ---
        function goGame(url) {
            toast("ƒêang v√†o tr√≤ ch∆°i...");
            setTimeout(() => {
                window.location.href = url;
            }, 800); // ƒê·ª£i 0.8s ƒë·ªÉ ng∆∞·ªùi d√πng th·∫•y hi·ªáu ·ª©ng th√¥ng b√°o
        }
    </script>
    <footer id="copyright"
    style="
        position: fixed;
        bottom: 6px;
        left: 50%;
        transform: translateX(-50%);
        font-size: 11px;
        color: #ffffff;
        opacity: 0.8;
        font-weight: 700;
        letter-spacing: 0.5px;
        user-select: none;
        pointer-events: none;
        z-index: 9999;
        text-shadow: 0 0 3px rgba(0,0,0,0.6);
    ">
    ¬© 2026 Luavang ‚Äì All Rights Reserved
</footer>
</body>
</html>